<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <title>AMR-GraphNet :: Tool</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="./assets/css/site.css">
    <link rel="stylesheet" href="./assets/css/style.css">
    <style>
        /* Basic styling for the graph layout */
        html, body { width:100%; height:100%; margin:0; }
        svg { width: 100%; height: 100%; }
        path.link { stroke-opacity:.6; fill:none; }
        path.node { cursor:grab; }
        text.label { font:12px system-ui; pointer-events:none; }
    </style>
</head>

<body>
<div class="container-fluid">
    <header class="d-flex flex-wrap align-items-center justify-content-center justify-content-md-between py-3 mb-4 border-bottom">
        <a href="index.html" class="d-flex align-items-center col-md-3 mb-2 mb-md-0 text-dark text-decoration-none">
            <img src="assets/img/Logo.svg" alt="AMR-GraphNet Logo" width="35" height="35" class="d-inline-block align-text-middle">
            <span class="fs-4 ms-2"> AMR-GraphNet </span>
        </a>
        <ul class="nav col-12 col-md-auto mb-2 justify-content-center mb-md-0 tool">
            <li><a href="./index.html" class="nav-link px-2 link-dark nav-about">About</a></li>
            <li><a href="./tool.html" class="nav-link px-2 link-dark nav-tool">Tool</a></li>
            <li><a href="./downloads.html" class="nav-link px-2 link-dark nav-downloads">Downloads</a></li>
            <li><a href="./contact.html" class="nav-link px-2 link-dark nav-contact">Contact</a></li>
        </ul>
    </header>

    <div id="menu" class="card p-2 mb-3">
        <div class="row g-3 align-items-end">
            <!-- Graph View Selection -->
            <div class="col-md-4 col-lg-3">
                <label for="dataset" class="form-label"><strong>Graph View</strong></label>
                <select id="dataset" class="form-select">
                    <option value="json/graph1.json">ARG-MGE Interaction View</option>
                    <option value="json/graph2.json">Colocalization View</option>
                </select>
            </div>

            <!-- Disease Filter -->
            <div class="col-md-4 col-lg-2">
                <label for="diseaseFilter" class="form-label"><strong>Disease</strong></label>
                <select id="diseaseFilter" class="form-select">
                    <option value="all" selected>All Diseases</option>
                    <option value="Melanoma">Melanoma</option>
                    <option value="MDRB">MDRB</option>
                    <option value="rCDI">rCDI</option>
                </select>
            </div>

            <!-- MGE Group Filter -->
            <div class="col-md-4 col-lg-2">
                <label for="mgeGroupFilter" class="form-label"><strong>MGE Group</strong></label>
                <select id="mgeGroupFilter" class="form-select">
                    <option value="all" selected>All Groups</option>
                    <!-- Options will be populated by JavaScript -->
                </select>
            </div>

            <!-- Timepoint Filter -->
            <div class="col-md-4 col-lg-3">
                <label class="form-label"><strong>Patient Stages</strong></label>
                <div id="timepointFilter" class="d-flex flex-wrap gap-2">
                    <div class="form-check">
                        <input class="form-check-input timepoint-checkbox" type="checkbox" value="donor" id="stage-donor" checked>
                        <label class="form-check-label" for="stage-donor">Donor</label>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input timepoint-checkbox" type="checkbox" value="pre" id="stage-pre" checked>
                        <label class="form-check-label" for="stage-pre">Pre-FMT</label>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input timepoint-checkbox" type="checkbox" value="post1" id="stage-post1" checked>
                        <label class="form-check-label" for="stage-post1">Post-FMT (1–30d)</label>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input timepoint-checkbox" type="checkbox" value="post2" id="stage-post2" checked>
                        <label class="form-check-label" for="stage-post2">Post-FMT (31–60d)</label>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input timepoint-checkbox" type="checkbox" value="post3" id="stage-post3" checked>
                        <label class="form-check-label" for="stage-post3">Post-FMT (61+d)</label>
                    </div>
                </div>
            </div>

            <!-- Search by Label -->
            <div class="col-md-4 col-lg-3">
                <label for="argSearch" class="form-label"><strong>Search ARGs</strong></label>
                <input type="text" id="argSearch" class="form-control" placeholder="">
            </div>

            <div class="col-md-4 col-lg-3">
                <label for="mgeSearch" class="form-label"><strong>Search MGEs</strong></label>
                <input type="text" id="mgeSearch" class="form-control" placeholder="">
            </div>
            
            <div class="col-md-4 col-lg-2 d-flex align-items-end">
                <button class="btn btn-outline-secondary w-100" type="button" id="resetBtn">Reset Filters</button>
            </div>
            
             <!-- Display Toggles -->
            <div class="col-12">
                <div class="d-flex align-items-center gap-3 mt-2">
                    <strong>Display Toggles:</strong>
                    <div class="form-check form-switch">
                        <input class="form-check-input" type="checkbox" id="toggleLabels" checked>
                        <label class="form-check-label" for="toggleLabels">Labels</label>
                    </div>
                    <div class="form-check form-switch">
                        <input class="form-check-input" type="checkbox" id="toggleColo" checked>
                        <label class="form-check-label" for="toggleColo">Colocalization Links</label>
                    </div>
                    <div class="form-check form-switch">
                        <input class="form-check-input" type="checkbox" id="toggleTemporal" checked>
                        <label class="form-check-label" for="toggleTemporal">Temporal Links</label>
                    </div>
                    <div class="form-check form-switch">
                        <input class="form-check-input" type="checkbox" id="toggleLegend">
                        <label class="form-check-label" for="toggleLegend">Legend</label>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div id="graph-container">
        <svg id="graph" viewBox="0 0 1000 700" preserveAspectRatio="xMidYMid meet"></svg>
    </div>

    <div id="legendOverlay" class="legend-overlay">
        <div class="legend-content">
            <h6><strong>Graph Legend</strong></h6>
            <div class="legend-section">
                <p><strong>Nodes:</strong></p>
                <ul>
                    <li><span class="legend-symbol arg"></span> ARG Node</li>
                    <li><span class="legend-symbol mge"></span> MGE Node</li>
                </ul>
            </div>
            <div class="legend-section">
                <p><strong>Edges:</strong></p>
                <ul>
                    <li><span class="legend-line colo"></span> Colocalization Link</li>
                    <li><span class="legend-line temporal"></span> Temporal Link</li>
                </ul>
            </div>
        </div>
    </div>
    
    <div id="tooltip" style="position:absolute; background:rgba(255,255,255,0.9); border:1px solid #ccc; padding:4px 8px; border-radius:4px; pointer-events:none; font-size:12px; display:none;"></div>
</div>

<!-- Scripts -->
<script src="https://cdn.jsdelivr.net/npm/d3@7"></script>
<script src="assets/js/graph.js"></script>
<script type="module" src="./assets/js/site.js"></script>

</body>
</html>
